<div class="card border shadow-sm">
    <div class="card-body">
        {% if ingredient_error %}
            <div class="invalid-feedback d-block mb-3">
                {{ ingredient_error }}
            </div>
        {% endif %}
        <div class="scrollable-container">
            <!-- Labels row - only show once -->
            <div class="row g-2 mb-2">
                <div class="col-1"></div>
                <div class="col-6">
                    <label class="form-label fw-semibold text-dark mb-0 small">Name</label>
                </div>
                <div class="col-2">
                    <label class="form-label fw-semibold text-dark mb-0 small">Amount</label>
                </div>
                <div class="col-2">
                    <label class="form-label fw-semibold text-dark mb-0 small">Units</label>
                </div>
                <div class="col-1"></div>
            </div>
            {% for ingredient in ingredients %}
            <div class="ingredient-row row mb-3 g-2">
                <div class="col-1 d-flex align-items-center justify-content-center">
                    <span class="fw-bold text-muted">{{ forloop.counter }}</span>
                </div>
                <div class="col-6 d-flex align-items-center">
                    <input type="text" 
                           name="ingredient_name_{{ forloop.counter0 }}" 
                           class="form-control" 
                           value="{{ ingredient.name }}"
                           placeholder="Enter ingredient name">
                </div>
                <div class="col-2 d-flex align-items-center">
                    <input type="number" 
                           name="ingredient_amount_{{ forloop.counter0 }}" 
                           class="form-control" 
                           value="{{ ingredient.amount }}"
                           min="1"
                           placeholder="Amount">
                </div>
                <div class="col-2 d-flex align-items-center">
                    <select name="ingredient_units_{{ forloop.counter0 }}" 
                            class="form-control">
                        <option value="ml" {% if ingredient.units == 'ml' %}selected{% endif %}>ml</option>
                        <option value="g" {% if ingredient.units == 'g' %}selected{% endif %}>g</option>
                        <option value="L" {% if ingredient.units == 'L' %}selected{% endif %}>L</option>
                        <option value="kg" {% if ingredient.units == 'kg' %}selected{% endif %}>kg</option>
                        <option value="oz" {% if ingredient.units == 'oz' %}selected{% endif %}>oz</option>
                    </select>
                </div>
                <div class="col-1 d-flex align-items-center justify-content-center">
                    {% if not forloop.first %}
                        <button type="submit" 
                                name="delete_ingredient_{{ forloop.counter0 }}" 
                                value="true"
                                class="btn btn-outline-danger btn-sm"
                                formnovalidate>
                            <i class="bi bi-trash"></i>
                        </button>
                    {% else %}
                        <div class="spacer-32"></div>
                    {% endif %}
                </div>
                {% if ingredient.id %}
                    <input type="hidden" name="ingredient_id_{{ forloop.counter0 }}" value="{{ ingredient.id }}">
                {% endif %}
            </div>
            {% empty %}
            <div class="ingredient-row row mb-3 g-2">
                <div class="col-1 d-flex align-items-center justify-content-center">
                    <span class="fw-bold text-muted">1</span>
                </div>
                <div class="col-6 d-flex align-items-center">
                    <input type="text" 
                           name="ingredient_name_0" 
                           class="form-control" 
                           value=""
                           placeholder="Enter ingredient name">
                </div>
                <div class="col-2 d-flex align-items-center">
                    <input type="number" 
                           name="ingredient_amount_0" 
                           class="form-control" 
                           value=""
                           min="1"
                           placeholder="Amount">
                </div>
                <div class="col-2 d-flex align-items-center">
                    <select name="ingredient_units_0" class="form-control">
                        <option value="ml">ml</option>
                        <option value="g" selected>g</option>
                        <option value="L">L</option>
                        <option value="kg">kg</option>
                        <option value="oz">oz</option>
                    </select>
                </div>
                <div class="col-1 d-flex align-items-center justify-content-center">
                    <div class="spacer-32"></div>
                </div>
            </div>
            {% endfor %}
        </div>
        <div class="mt-3 pt-3 border-top">
            <button type="submit" name="add_ingredient" value="true" class="btn btn-outline-danger w-100" formnovalidate>
                <i class="bi bi-plus-circle me-2"></i>Add Ingredient
            </button>
        </div>
    </div>
</div>
